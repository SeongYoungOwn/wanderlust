<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tour.project.dao.MbtiCompatibilityDAO">

    <!-- 특정 MBTI의 최적 매칭 MBTI 조회 -->
    <select id="getBestMatch" parameterType="String" resultType="com.tour.project.dto.MbtiCompatibilityDTO">
        SELECT compatibility_id as compatibilityId, mbti_type_1 as mbtiType1, mbti_type_2 as mbtiType2,
               compatibility_score as compatibilityScore, synergy_description as synergyDescription,
               recommended_destinations as recommendedDestinations, travel_style_balance as travelStyleBalance,
               created_date as createdDate
        FROM mbti_compatibility
        WHERE mbti_type_1 = #{mbtiType}
        ORDER BY compatibility_score DESC
        LIMIT 1
    </select>
    
    <!-- 두 MBTI 간의 호환성 점수 조회 -->
    <select id="getCompatibilityScore" resultType="int">
        SELECT compatibility_score
        FROM mbti_compatibility
        WHERE (mbti_type_1 = #{mbti1} AND mbti_type_2 = #{mbti2})
           OR (mbti_type_1 = #{mbti2} AND mbti_type_2 = #{mbti1})
        LIMIT 1
    </select>
    
    <!-- 모든 호환성 데이터 조회 -->
    <select id="getAllCompatibilities" resultType="com.tour.project.dto.MbtiCompatibilityDTO">
        SELECT compatibility_id as compatibilityId, mbti_type_1 as mbtiType1, mbti_type_2 as mbtiType2,
               compatibility_score as compatibilityScore, synergy_description as synergyDescription,
               recommended_destinations as recommendedDestinations, travel_style_balance as travelStyleBalance,
               created_date as createdDate
        FROM mbti_compatibility
        ORDER BY compatibility_score DESC
    </select>
    
    <!-- 특정 MBTI와 호환되는 모든 MBTI 조회 -->
    <select id="getCompatibleMbtis" parameterType="String" resultType="com.tour.project.dto.MbtiCompatibilityDTO">
        SELECT compatibility_id as compatibilityId, mbti_type_1 as mbtiType1, mbti_type_2 as mbtiType2,
               compatibility_score as compatibilityScore, synergy_description as synergyDescription,
               recommended_destinations as recommendedDestinations, travel_style_balance as travelStyleBalance,
               created_date as createdDate
        FROM mbti_compatibility
        WHERE mbti_type_1 = #{mbtiType}
        ORDER BY compatibility_score DESC
    </select>

</mapper>